{"ast":null,"code":"import _objectSpread from\"/root/PetPulse-Ai/frontend/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import React,{useState,useEffect}from'react';import{toast}from'react-toastify';import{vaccinationsService,petsService}from'../services/api';import{formatDate,getStatusColor}from'../utils/helpers';import{VACCINATION_TYPES,VACCINATION_STATUS}from'../utils/constants';import LoadingSpinner from'./LoadingSpinner';import{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";const VaccinationTracker=()=>{var _completingVax$pet;const[vaccinations,setVaccinations]=useState([]);const[pets,setPets]=useState([]);const[loading,setLoading]=useState(false);const[selectedPet,setSelectedPet]=useState('');const[showForm,setShowForm]=useState(false);const[completingVax,setCompletingVax]=useState(null);const[formData,setFormData]=useState({petId:'',vaccineName:'',type:'core',scheduledDate:'',dueDate:'',notes:'',dosage:''});useEffect(()=>{fetchData();},[]);const fetchData=async()=>{try{setLoading(true);const[petsRes,vaxRes]=await Promise.all([petsService.getAll(),vaccinationsService.getAll()]);setPets(petsRes.data.pets||[]);setVaccinations(vaxRes.data.vaccinations||[]);if(petsRes.data.pets.length>0){setSelectedPet(petsRes.data.pets[0]._id);setFormData(prev=>_objectSpread(_objectSpread({},prev),{},{petId:petsRes.data.pets[0]._id}));}}catch(error){console.error('Error fetching data:',error);toast.error('Error loading data');}finally{setLoading(false);}};const handleGenerateSchedule=async petId=>{try{setLoading(true);await vaccinationsService.generateSchedule(petId);toast.success('Vaccination schedule generated!');fetchData();}catch(error){console.error('Error generating schedule:',error);toast.error('Error generating vaccination schedule');}finally{setLoading(false);}};const handleMarkComplete=async function(vaxId){let administeredDate=arguments.length>1&&arguments[1]!==undefined?arguments[1]:new Date();try{await vaccinationsService.complete(vaxId,{administeredDate:administeredDate.toISOString()});toast.success('Vaccination marked as completed!');setCompletingVax(null);fetchData();}catch(error){console.error('Error completing vaccination:',error);toast.error('Error updating vaccination');}};const handleSubmit=async e=>{e.preventDefault();setLoading(true);try{var _pets$;await vaccinationsService.create(formData);toast.success('Vaccination scheduled successfully!');setShowForm(false);setFormData({petId:((_pets$=pets[0])===null||_pets$===void 0?void 0:_pets$._id)||'',vaccineName:'',type:'core',scheduledDate:'',dueDate:'',notes:'',dosage:''});fetchData();}catch(error){var _error$response,_error$response$data;console.error('Error creating vaccination:',error);toast.error(((_error$response=error.response)===null||_error$response===void 0?void 0:(_error$response$data=_error$response.data)===null||_error$response$data===void 0?void 0:_error$response$data.message)||'Error scheduling vaccination');}finally{setLoading(false);}};const handleChange=e=>{setFormData(_objectSpread(_objectSpread({},formData),{},{[e.target.name]:e.target.value}));};const filteredVaccinations=selectedPet?vaccinations.filter(vax=>{var _vax$pet;return((_vax$pet=vax.pet)===null||_vax$pet===void 0?void 0:_vax$pet._id)===selectedPet;}):vaccinations;const upcomingVaccinations=filteredVaccinations.filter(vax=>vax.status==='scheduled'&&new Date(vax.dueDate)>new Date());const completedVaccinations=filteredVaccinations.filter(vax=>vax.status==='completed');const overdueVaccinations=filteredVaccinations.filter(vax=>vax.status==='scheduled'&&new Date(vax.dueDate)<new Date());const isOverdue=dueDate=>{return new Date(dueDate)<new Date();};return/*#__PURE__*/_jsxs(\"div\",{className:\"vaccinations-container\",children:[/*#__PURE__*/_jsxs(\"header\",{className:\"page-header\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h1\",{children:\"\\uD83D\\uDC89 Vaccination Tracker\"}),/*#__PURE__*/_jsx(\"p\",{children:\"Manage and track your pet's vaccination schedule\"})]}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>setShowForm(true),className:\"btn btn-primary\",children:\"+ Schedule Vaccination\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"filters-section\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"filter-group\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Filter by Pet:\"}),/*#__PURE__*/_jsxs(\"select\",{value:selectedPet,onChange:e=>setSelectedPet(e.target.value),children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",children:\"All Pets\"}),pets.map(pet=>/*#__PURE__*/_jsx(\"option\",{value:pet._id,children:pet.name},pet._id))]})]}),pets.length>0&&/*#__PURE__*/_jsx(\"div\",{className:\"actions-group\",children:/*#__PURE__*/_jsx(\"button\",{onClick:()=>{const petId=selectedPet||pets[0]._id;handleGenerateSchedule(petId);},className:\"btn btn-secondary\",disabled:loading,children:\"Generate Schedule\"})})]}),showForm&&/*#__PURE__*/_jsx(\"div\",{className:\"modal-overlay\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"modal\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"modal-header\",children:[/*#__PURE__*/_jsx(\"h2\",{children:\"Schedule New Vaccination\"}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>setShowForm(false),className:\"btn-close\",children:\"\\xD7\"})]}),/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleSubmit,className:\"vaccination-form\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Pet *\"}),/*#__PURE__*/_jsxs(\"select\",{name:\"petId\",value:formData.petId,onChange:handleChange,required:true,children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",children:\"Select a pet\"}),pets.map(pet=>/*#__PURE__*/_jsxs(\"option\",{value:pet._id,children:[pet.name,\" (\",pet.species,\")\"]},pet._id))]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Vaccine Name *\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",name:\"vaccineName\",value:formData.vaccineName,onChange:handleChange,required:true,placeholder:\"Enter vaccine name\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-row\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Vaccine Type *\"}),/*#__PURE__*/_jsx(\"select\",{name:\"type\",value:formData.type,onChange:handleChange,required:true,children:VACCINATION_TYPES.map(type=>/*#__PURE__*/_jsx(\"option\",{value:type.value,children:type.label},type.value))})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Dosage\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",name:\"dosage\",value:formData.dosage,onChange:handleChange,placeholder:\"Dosage amount\"})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-row\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Scheduled Date *\"}),/*#__PURE__*/_jsx(\"input\",{type:\"date\",name:\"scheduledDate\",value:formData.scheduledDate,onChange:handleChange,required:true})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Due Date *\"}),/*#__PURE__*/_jsx(\"input\",{type:\"date\",name:\"dueDate\",value:formData.dueDate,onChange:handleChange,required:true})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Notes\"}),/*#__PURE__*/_jsx(\"textarea\",{name:\"notes\",value:formData.notes,onChange:handleChange,placeholder:\"Additional notes about this vaccination\",rows:\"3\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-actions\",children:[/*#__PURE__*/_jsx(\"button\",{type:\"button\",onClick:()=>setShowForm(false),className:\"btn btn-secondary\",children:\"Cancel\"}),/*#__PURE__*/_jsx(\"button\",{type:\"submit\",disabled:loading,className:\"btn btn-primary\",children:loading?'Scheduling...':'Schedule Vaccination'})]})]})]})}),completingVax&&/*#__PURE__*/_jsx(\"div\",{className:\"modal-overlay\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"modal\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"modal-header\",children:[/*#__PURE__*/_jsx(\"h2\",{children:\"Mark Vaccination as Completed\"}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>setCompletingVax(null),className:\"btn-close\",children:\"\\xD7\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"modal-content\",children:[/*#__PURE__*/_jsxs(\"p\",{children:[\"Are you sure you want to mark \",/*#__PURE__*/_jsx(\"strong\",{children:completingVax.vaccineName}),\" for \",/*#__PURE__*/_jsx(\"strong\",{children:(_completingVax$pet=completingVax.pet)===null||_completingVax$pet===void 0?void 0:_completingVax$pet.name}),\" as completed?\"]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-actions\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:()=>setCompletingVax(null),className:\"btn btn-secondary\",children:\"Cancel\"}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>handleMarkComplete(completingVax._id),className:\"btn btn-primary\",children:\"Mark Completed\"})]})]})]})}),loading?/*#__PURE__*/_jsx(LoadingSpinner,{text:\"Loading vaccinations...\",centered:true}):/*#__PURE__*/_jsxs(_Fragment,{children:[overdueVaccinations.length>0&&/*#__PURE__*/_jsxs(\"div\",{className:\"section urgent-section\",children:[/*#__PURE__*/_jsx(\"h2\",{children:\"\\u26A0\\uFE0F Overdue Vaccinations\"}),/*#__PURE__*/_jsx(\"div\",{className:\"vaccinations-grid\",children:overdueVaccinations.map(vax=>{var _vax$pet2;return/*#__PURE__*/_jsxs(\"div\",{className:\"vaccination-card overdue\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"vax-header\",children:[/*#__PURE__*/_jsx(\"h3\",{children:vax.vaccineName}),/*#__PURE__*/_jsx(\"span\",{className:\"status-badge status-overdue\",children:\"Overdue\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"vax-details\",children:[/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Pet:\"}),\" \",(_vax$pet2=vax.pet)===null||_vax$pet2===void 0?void 0:_vax$pet2.name]}),/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Due Date:\"}),\" \",formatDate(vax.dueDate)]}),/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Type:\"}),\" \",vax.type]}),vax.notes&&/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Notes:\"}),\" \",vax.notes]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"vax-actions\",children:/*#__PURE__*/_jsx(\"button\",{onClick:()=>setCompletingVax(vax),className:\"btn btn-primary\",children:\"Mark Complete\"})})]},vax._id);})})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"section\",children:[/*#__PURE__*/_jsx(\"h2\",{children:\"Upcoming Vaccinations\"}),upcomingVaccinations.length===0?/*#__PURE__*/_jsx(\"div\",{className:\"empty-state\",children:/*#__PURE__*/_jsx(\"p\",{children:\"No upcoming vaccinations scheduled.\"})}):/*#__PURE__*/_jsx(\"div\",{className:\"vaccinations-grid\",children:upcomingVaccinations.map(vax=>{var _vax$pet3;return/*#__PURE__*/_jsxs(\"div\",{className:\"vaccination-card\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"vax-header\",children:[/*#__PURE__*/_jsx(\"h3\",{children:vax.vaccineName}),/*#__PURE__*/_jsx(\"span\",{className:\"status-badge\",style:{backgroundColor:getStatusColor(vax.status)},children:vax.status})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"vax-details\",children:[/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Pet:\"}),\" \",(_vax$pet3=vax.pet)===null||_vax$pet3===void 0?void 0:_vax$pet3.name]}),/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Due Date:\"}),\" \",formatDate(vax.dueDate)]}),/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Type:\"}),\" \",vax.type]}),vax.notes&&/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Notes:\"}),\" \",vax.notes]})]}),isOverdue(vax.dueDate)&&/*#__PURE__*/_jsx(\"div\",{className:\"overdue-warning\",children:\"\\u26A0\\uFE0F Overdue\"}),/*#__PURE__*/_jsx(\"div\",{className:\"vax-actions\",children:/*#__PURE__*/_jsx(\"button\",{onClick:()=>setCompletingVax(vax),className:\"btn btn-primary\",children:\"Mark Complete\"})})]},vax._id);})})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"section\",children:[/*#__PURE__*/_jsx(\"h2\",{children:\"Vaccination History\"}),completedVaccinations.length===0?/*#__PURE__*/_jsx(\"div\",{className:\"empty-state\",children:/*#__PURE__*/_jsx(\"p\",{children:\"No vaccination history yet.\"})}):/*#__PURE__*/_jsx(\"div\",{className:\"vaccinations-list\",children:completedVaccinations.map(vax=>{var _vax$pet4,_vax$veterinarian;return/*#__PURE__*/_jsxs(\"div\",{className:\"vaccination-item completed\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"vax-info\",children:[/*#__PURE__*/_jsx(\"h4\",{children:vax.vaccineName}),/*#__PURE__*/_jsxs(\"p\",{children:[(_vax$pet4=vax.pet)===null||_vax$pet4===void 0?void 0:_vax$pet4.name,\" \\u2022 Administered: \",formatDate(vax.administeredDate)]}),((_vax$veterinarian=vax.veterinarian)===null||_vax$veterinarian===void 0?void 0:_vax$veterinarian.name)&&/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Veterinarian:\"}),\" \",vax.veterinarian.name]}),vax.notes&&/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Notes:\"}),\" \",vax.notes]})]}),/*#__PURE__*/_jsx(\"span\",{className:\"status-badge status-completed\",children:\"Completed\"})]},vax._id);})})]})]}),pets.length===0&&!loading&&/*#__PURE__*/_jsxs(\"div\",{className:\"empty-state\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"empty-icon\",children:\"\\uD83D\\uDC15\"}),/*#__PURE__*/_jsx(\"h3\",{children:\"No Pets Found\"}),/*#__PURE__*/_jsx(\"p\",{children:\"Add a pet first to track vaccinations.\"})]})]});};export default VaccinationTracker;","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}